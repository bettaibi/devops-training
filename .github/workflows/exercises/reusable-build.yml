# Exercise 3: Reusable Build Template
#
# GOAL: This is a TEMPLATE workflow that can be called by others.
#
# Requirements:
# 1. Use the 'workflow_call' trigger
# 2. Accept two inputs:
#    - 'working_directory' (string, required)
#    - 'artifact_name' (string, default: 'build-output')
# 3. Accept one secret:
#    - 'DEPLOY_TOKEN' (required)
#
# 4. Create a single job named 'build' that:
#    - Uses the input 'working_directory' for its defaults
#    - Checks out code
#    - Sets up Node 22
#    - Installs dependencies (npm ci)
#    - Builds the project (npm run build)
#    - Uploads the '.next' folder (using the 'artifact_name' input)
#    - Echoes "Building with token: ${{ secrets.DEPLOY_TOKEN }}" (Simulating usage)
#
# HINTS:
# - workflow_call inputs syntax: inputs.input_name (type, required, default)
# - Use ${{ inputs.working_directory }} to reference inputs
# - Use ${{ secrets.DEPLOY_TOKEN }} to reference secrets
# - For artifact path, use: ${{ github.workspace }}/${{ inputs.working_directory }}/.next/
#
# YOUR SOLUTION BELOW:
# ====================

name: Reusable Build Template
on:
  workflow_call:
    # TODO: Define inputs here
    
    # TODO: Define secrets here

jobs:
  build:
    runs-on: ubuntu-latest
    # TODO: Set defaults using the input
    
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 22
          cache: 'npm'
      
      - name: Install
        run: npm ci
        
      - name: Build
        run: npm run build
        
      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          # TODO: Use the artifact_name input here
          name: build-output # placeholder
          path: .next/ # placeholder - you'll need to fix this
          include-hidden-files: true
          
      - name: Deployment
        run: echo "Building with token: [TODO: use secret here]"
